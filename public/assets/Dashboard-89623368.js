import{A as I,$ as u,a2 as w,a7 as v,Z as m,V as D,c as S,a0 as B,a1 as o,F as X,a3 as te,u as r,D as t,R as Qe,I as R,a5 as Oe,ab as We,a4 as O,ac as Ke,ad as He,r as L,d as ze,C as ce,h as qe,Y as H,ag as de,i as ee,_ as Ge,ah as Ze,ai as et,w as tt,J as at,aj as ot,q as Ue,O as ke,Q as Te}from"./vue-aae79161.js";import{V as Me,_ as Se,u as ae,f as lt,a as nt,T as A,b as st,c as rt,d as it,e as dt,g as ue,h as J,i as je,j as me,k as z,l as xe,D as U,m as Ve,n as pe,o as Ye,p as Ce,q as Z,r as De,s as Ie,t as Le,v as q,w as Ee,x as E,y as Pe,z as ut,A as $e,B as Be,C as ie,E as we,F as Xe,G as ct,H as K,I as Je,J as mt,K as pt,L as Re,M as vt,N as ht,O as Ne}from"./index-4e506bc5.js";import{_ as _t}from"./MoveTorrentDialog.vue_vue_type_script_setup_true_lang-8ecb04a2.js";import{d as Ae}from"./dayjs.min-eab5b7ae.js";import{u as ft}from"./ArrayPagination-a220296b.js";import{d as bt}from"./index-365abc82.js";const gt={class:"d-flex flex-column"},yt={class:"text-caption text-grey"},kt={class:"text-caption text-grey"},Tt=I({__name:"ItemAmount",props:{torrent:{},title:{},value:{},total:{}},setup(T){return(e,l)=>(u(),w("div",gt,[v("div",yt,m(e.$t(`torrent.properties.${e.title}`)),1),v("div",null,[D(m(e.torrent[e.value])+" ",1),v("span",kt," / "+m(e.torrent[e.total]),1)])]))}}),Vt={class:"d-flex flex-column"},$t={class:"text-caption text-grey"},wt={class:"d-flex flex-row gap"},xt=I({__name:"ItemChip",props:{torrent:{},title:{},value:{},color:{}},setup(T){const e=T,l=S(()=>{const a=e.torrent[e.value],p=typeof a;if(p==="string")return a.length>0?[a]:[];if(p==="object")return a});return(a,p)=>(u(),w("div",Vt,[v("div",$t,m(a.$t(`torrent.properties.${a.title}`)),1),v("div",wt,[!l.value||l.value.length<1?(u(),B(Me,{key:0,color:a.color.replace("$1",a.torrent[a.value]),variant:"flat"},{default:o(()=>[D(m(a.$t(`torrent.properties.empty_${a.value}`)),1)]),_:1},8,["color"])):(u(!0),w(X,{key:1},te(l.value,g=>(u(),B(Me,{color:a.color.replace("$1",a.torrent.state),variant:"flat"},{default:o(()=>[D(m(g),1)]),_:2},1032,["color"]))),256))])]))}});const Bt=Se(xt,[["__scopeId","data-v-8eb4906a"]]),St={class:"d-flex flex-column"},Ct={class:"text-caption text-grey"},Dt={class:"text-caption text-grey"},It=I({__name:"ItemData",props:{torrent:{},title:{},value:{}},setup(T){const e=ae();return(l,a)=>(u(),w("div",St,[v("div",Ct,m(l.$t(`torrent.properties.${l.title}`)),1),v("div",null,[D(m(r(lt)(l.torrent[l.value],r(e).useBinarySize))+" ",1),v("span",Dt,m(r(nt)(l.torrent[l.value],r(e).useBinarySize)),1)])]))}}),Lt={class:"d-flex flex-column"},Et={class:"text-caption text-grey"},Pt={key:0},At={key:1},Ut=I({__name:"ItemDateTime",props:{torrent:{},title:{},value:{}},setup(T){const e=ae();return(l,a)=>(u(),w("div",Lt,[v("div",Et,m(l.$t(`torrent.properties.${l.title}`)),1),v("div",null,[l.torrent[l.value]>0?(u(),w("span",Pt,m(r(Ae)(l.torrent[l.value]*1e3).format(r(e).dateFormat??"DD/MM/YYYY, HH:mm:ss")),1)):(u(),w("span",At,m(l.$t("dashboard.not_complete")),1))])]))}}),Mt={class:"d-flex flex-column"},Rt={class:"text-caption text-grey"},Nt={key:0},Ft={key:1},Ot="D[d] H[h] m[m] s[s]",Kt=I({__name:"ItemDuration",props:{torrent:{},title:{},value:{}},setup(T){return(e,l)=>(u(),w("div",Mt,[v("div",Rt,m(e.$t(`torrent.properties.${e.title}`)),1),v("div",null,[e.torrent[e.value]>0?(u(),w("span",Nt,m(r(Ae).duration(e.torrent[e.value],"seconds").format(Ot)),1)):(u(),w("span",Ft,m(e.$t("dashboard.not_complete")),1))])]))}}),Ht={class:"d-flex flex-column"},zt={class:"text-caption text-grey"},qt=I({__name:"ItemPercent",props:{torrent:{},title:{},value:{}},setup(T){const e=T,l=S(()=>[A.UPLOADING,A.CHECKING_UP,A.FORCED_UP,A.ALLOCATING,A.DOWNLOADING,A.META_DL,A.CHECKING_DL,A.FORCED_DL,A.CHECKING_RESUME_DATA,A.MOVING].includes(e.torrent.state));return(a,p)=>(u(),w("div",Ht,[v("div",zt,m(a.$t(`torrent.properties.${a.title}`)),1),t(rt,{"model-value":a.torrent[a.value],max:1,striped:l.value,height:20,color:`torrent-${a.torrent.state}`,rounded:"sm",style:{width:"10em"}},{default:o(()=>[D(m(r(st)(a.torrent[a.value])),1)]),_:1},8,["model-value","striped","color"])]))}}),Gt={class:"d-flex flex-column"},jt={class:"text-caption text-grey"},Yt=I({__name:"ItemRelativeTime",props:{torrent:{},title:{},value:{}},setup(T){return(e,l)=>(u(),w("div",Gt,[v("div",jt,m(e.$t(`torrent.properties.${e.title}`)),1),v("div",null,[v("span",null,m(r(Ae)(e.torrent[e.value]*1e3).fromNow()),1)])]))}}),Xt={class:"d-flex flex-column"},Jt={class:"text-caption text-grey"},Qt={class:"text-caption text-grey"},Wt=I({__name:"ItemSpeed",props:{torrent:{},title:{},value:{}},setup(T){const e=ae();return(l,a)=>(u(),w("div",Xt,[v("div",Jt,m(l.$t(`torrent.properties.${l.title}`)),1),v("div",null,[D(m(r(it)(l.torrent[l.value],r(e).useBitSpeed))+" ",1),v("span",Qt,m(r(dt)(l.torrent[l.value],r(e).useBitSpeed)),1)])]))}}),Zt={class:"d-flex flex-column"},ea={class:"text-caption text-grey"},ta=I({__name:"ItemText",props:{torrent:{},title:{},value:{}},setup(T){return(e,l)=>(u(),w("div",Zt,[v("div",ea,m(e.$t(`torrent.properties.${e.title}`)),1),v("div",null,m(e.torrent[e.value]),1)]))}}),aa={class:"d-flex gap flex-wrap"},oa=I({__name:"Torrent",props:{torrent:{}},setup(T){const e=T,l=ue(),a=J(),p=ae(),g=S(()=>(e.torrent.progress===1?p.doneTorrentProperties:p.busyTorrentProperties).filter(y=>y.active).sort((y,f)=>y.order-f.order));function V(_){_.shiftKey?l.spanTorrentSelection(a.getTorrentIndexByHash(e.torrent.hash)):(xe(_)||l.isSelectionMultiple)&&(l.isSelectionMultiple=!0,l.toggleSelect(e.torrent.hash))}const i=_=>{switch(_){case U.AMOUNT:return Tt;case U.CHIP:return Bt;case U.DATA:return It;case U.DATETIME:return Ut;case U.DURATION:return Kt;case U.PERCENT:return qt;case U.RELATIVE:return Yt;case U.SPEED:return Wt;case U.TEXT:default:return ta}},c=S(()=>l.isTorrentInSelection(e.torrent.hash));return(_,y)=>(u(),B(z,{class:Oe(`sideborder ${_.torrent.state} pointer`),color:c.value?`torrent-${_.torrent.state}-darken-3`:void 0,width:"100%",onClick:V},{default:o(()=>[t(je,{class:"font-weight-bold text-wrap"},{default:o(()=>[D(m(_.torrent.name),1)]),_:1}),t(me,null,{default:o(()=>[v("div",aa,[(u(!0),w(X,null,te(g.value,f=>(u(),B(Qe(i(f.type)),R({torrent:_.torrent},f.props),null,16,["torrent"]))),256))])]),_:1})]),_:1},8,["class","color"]))}});const la=Se(oa,[["__scopeId","data-v-43ae49b8"]]),na={class:"d-flex"},sa={key:2},ra={key:3},ia=I({__name:"RightClickMenuEntry",props:{text:{},icon:{},action:{type:Function},hidden:{type:Boolean},disabled:{type:Boolean},disabledText:{},disabledIcon:{},divider:{type:Boolean},children:{}},setup(T){return(e,l)=>{const a=We("RightClickMenuEntry",!0);return e.hidden?O("",!0):(u(),B(Z,{key:0,class:"px-3 pointer",disabled:e.disabled,onClick:e.action},{default:o(()=>[v("div",na,[e.disabled&&e.disabledIcon?(u(),B(Ve,{key:0,class:"mr-2"},{default:o(()=>[D(m(e.disabledIcon),1)]),_:1})):e.icon?(u(),B(Ve,{key:1,class:"mr-2"},{default:o(()=>[D(m(e.icon),1)]),_:1})):O("",!0),e.disabled&&e.disabledText?(u(),w("span",sa,m(e.disabledText),1)):(u(),w("span",ra,m(e.text),1)),t(pe),e.children?(u(),B(Ve,{key:4},{default:o(()=>[D("mdi-chevron-right")]),_:1})):O("",!0)]),e.children?(u(),B(Ye,{key:0,activator:"parent","open-on-hover":!0,"open-on-click":!0,"close-delay":"0","open-delay":"0",location:"right"},{default:o(()=>[t(Ce,null,{default:o(()=>[(u(!0),w(X,null,te(e.children,p=>(u(),B(a,Ke(He(p)),null,16))),256))]),_:1})]),_:1})):O("",!0)]),_:1},8,["disabled","onClick"]))}}}),da=I({__name:"RenameTorrentDialog",props:{guid:{},hash:{}},setup(T){const e=T,{isOpened:l}=De(e.guid),{t:a}=Ie(),p=J(),g=L(),V=L(),i=L(!1),c=ze({newName:""}),_=[C=>!!C||a("dialogs.renameTorrent.required"),C=>C!==f.value||a("dialogs.renameTorrent.sameName")],y=S(()=>p.getTorrentByHash(e.hash)),f=S(()=>y.value?.name);async function $(){await V.value?.validate(),i.value&&(await p.renameTorrent(e.hash,c.newName),x())}const x=()=>{l.value=!1};return ce(()=>{c.newName=y.value?.name||""}),qe(()=>{g.value?.select()}),(C,b)=>(u(),B(Pe,{modelValue:r(l),"onUpdate:modelValue":b[3]||(b[3]=d=>ee(l)?l.value=d:null)},{default:o(()=>[t(z,null,{default:o(()=>[t(je,null,{default:o(()=>[D(m(C.$t("dialogs.renameTorrent.title")),1)]),_:1}),t(me,null,{default:o(()=>[t(r(Le),{modelValue:i.value,"onUpdate:modelValue":b[1]||(b[1]=d=>i.value=d),ref_key:"form",ref:V,onSubmit:b[2]||(b[2]=H(()=>{},["prevent"]))},{default:o(()=>[f.value?(u(),B(q,{key:0,"model-value":f.value,disabled:"",label:C.$t("dialogs.renameTorrent.oldName")},null,8,["model-value","label"])):O("",!0),t(q,{modelValue:c.newName,"onUpdate:modelValue":b[0]||(b[0]=d=>c.newName=d),ref_key:"field",ref:g,rules:_,autofocus:"",label:C.$t("dialogs.renameTorrent.newName"),onKeydown:de($,["enter"])},null,8,["modelValue","label","onKeydown"])]),_:1},8,["modelValue"])]),_:1}),t(Ee,null,{default:o(()=>[t(pe),t(E,{color:"error",onClick:x},{default:o(()=>[D(m(C.$t("common.cancel")),1)]),_:1}),t(E,{color:"accent",disabled:!i.value,onClick:$},{default:o(()=>[D(m(C.$t("common.save")),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),Y=-2,M=-1,ua=I({__name:"ShareLimitDialog",props:{guid:{},hash:{}},setup(T){const e=T,{isOpened:l}=De(e.guid),a=J(),p=L(!1),g=L("global"),V=L(!1),i=L(0),c=L(!1),_=L(0),y=L(!1),f=L(0),$=S(()=>g.value!=="enabled");function x(){l.value=!1}async function C(){switch(g.value){case"global":await a.setShareLimit([e.hash],Y,Y,Y);break;case"disabled":await a.setShareLimit([e.hash],M,M,M);break;case"enabled":await a.setShareLimit([e.hash],V.value?i.value:M,c.value?_.value:M,y.value?f.value:M);break}x()}return ce(async()=>{const b=a.getTorrentByHash(e.hash);if(!b)return x();const d=b.ratio_limit,k=b.seeding_time_limit,N=b.inactive_seeding_time_limit;d===Y&&k===Y&&N===Y?g.value="global":d===M&&k===M&&N===M?g.value="disabled":(g.value="enabled",V.value=d>=0,i.value=V.value?d:0,c.value=k>=0,_.value=c.value?k:0,y.value=N>=0,f.value=y.value?N:0)}),(b,d)=>(u(),B(Pe,{modelValue:r(l),"onUpdate:modelValue":d[9]||(d[9]=k=>ee(l)?l.value=k:null),"max-width":"500"},{default:o(()=>[t(z,{title:b.$t("dialogs.share_limit.title")},{default:o(()=>[t(me,null,{default:o(()=>[t(Le,{modelValue:p.value,"onUpdate:modelValue":d[7]||(d[7]=k=>p.value=k),onSubmit:d[8]||(d[8]=H(()=>{},["prevent"])),onKeydown:de(H(C,["prevent"]),["enter"])},{default:o(()=>[t(ut,{modelValue:g.value,"onUpdate:modelValue":d[0]||(d[0]=k=>g.value=k)},{default:o(()=>[t($e,{label:b.$t("dialogs.share_limit.global"),value:"global"},null,8,["label"]),t($e,{label:b.$t("dialogs.share_limit.disabled"),value:"disabled"},null,8,["label"]),t($e,{label:b.$t("dialogs.share_limit.enabled"),value:"enabled"},null,8,["label"])]),_:1},8,["modelValue"]),t(Be,null,{default:o(()=>[t(ie,{cols:"12",class:"d-flex align-center"},{default:o(()=>[v("span",null,[t(we,{modelValue:V.value,"onUpdate:modelValue":d[1]||(d[1]=k=>V.value=k),disabled:$.value},null,8,["modelValue","disabled"])]),t(q,{modelValue:i.value,"onUpdate:modelValue":d[2]||(d[2]=k=>i.value=k),disabled:$.value||!V.value,density:"compact","hide-details":"",label:b.$t("dialogs.share_limit.ratio_limit")},null,8,["modelValue","disabled","label"])]),_:1}),t(ie,{cols:"12",class:"d-flex align-center"},{default:o(()=>[v("span",null,[t(we,{modelValue:c.value,"onUpdate:modelValue":d[3]||(d[3]=k=>c.value=k),disabled:$.value},null,8,["modelValue","disabled"])]),t(q,{modelValue:_.value,"onUpdate:modelValue":d[4]||(d[4]=k=>_.value=k),disabled:$.value||!c.value,density:"compact","hide-details":"",label:b.$t("dialogs.share_limit.seeding_time_limit")},null,8,["modelValue","disabled","label"])]),_:1}),t(ie,{cols:"12",class:"d-flex align-center"},{default:o(()=>[v("span",null,[t(we,{modelValue:y.value,"onUpdate:modelValue":d[5]||(d[5]=k=>y.value=k),disabled:$.value},null,8,["modelValue","disabled"])]),t(q,{modelValue:f.value,"onUpdate:modelValue":d[6]||(d[6]=k=>f.value=k),disabled:$.value||!y.value,density:"compact","hide-details":"",label:b.$t("dialogs.share_limit.inactive_seeding_time_limit")},null,8,["modelValue","disabled","label"])]),_:1})]),_:1})]),_:1},8,["modelValue","onKeydown"])]),_:1}),t(Ee,null,{default:o(()=>[t(pe),t(E,{color:"error",onClick:x},{default:o(()=>[D(m(b.$t("common.cancel")),1)]),_:1}),t(E,{color:"accent",disabled:!p.value,onClick:C},{default:o(()=>[D(m(b.$t("common.save")),1)]),_:1},8,["disabled"])]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"]))}}),Fe=I({__name:"SpeedLimitDialog",props:{guid:{},hash:{},mode:{}},setup(T){const e=T,{isOpened:l}=De(e.guid),a=J(),p=L(!1),g=L(0);function V(){l.value=!1}async function i(){const c=Math.max(0,g.value)*1e3;switch(e.mode){case"download":await a.setDownloadLimit(c,[e.hash]);break;case"upload":await a.setUploadLimit(c,[e.hash]);break}V()}return ce(async()=>{const c=a.getTorrentByHash(e.hash);if(!c)return V();switch(e.mode){case"download":g.value=Math.max(0,Math.round(c.dl_limit/1e3));break;case"upload":g.value=Math.max(0,Math.round(c.up_limit/1e3));break}}),(c,_)=>(u(),B(Pe,{modelValue:r(l),"onUpdate:modelValue":_[3]||(_[3]=y=>ee(l)?l.value=y:null)},{default:o(()=>[t(z,{title:c.$t(`dialogs.speed_limit.${c.mode}`)},{default:o(()=>[t(me,null,{default:o(()=>[t(Le,{modelValue:p.value,"onUpdate:modelValue":_[1]||(_[1]=y=>p.value=y),onSubmit:_[2]||(_[2]=H(()=>{},["prevent"])),onKeydown:de(H(i,["prevent"]),["enter"])},{default:o(()=>[t(q,{modelValue:g.value,"onUpdate:modelValue":_[0]||(_[0]=y=>g.value=y),type:"number",autofocus:"",clearable:"",label:c.$t("dialogs.speed_limit.label"),"prepend-inner-icon":"mdi-speedometer",suffix:"kB/s",onKeydown:de(H(i,["prevent"]),["enter"])},null,8,["modelValue","label","onKeydown"])]),_:1},8,["modelValue","onKeydown"])]),_:1}),t(Ee,null,{default:o(()=>[t(pe),t(E,{color:"error",onClick:V},{default:o(()=>[D(m(c.$t("common.cancel")),1)]),_:1}),t(E,{color:"accent",disabled:!p.value,onClick:i},{default:o(()=>[D(m(c.$t("common.save")),1)]),_:1},8,["disabled"])]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"]))}}),ve=T=>(Ze("data-v-18d5c938"),T=T(),et(),T),ca={class:"d-flex justify-space-around"},ma=ve(()=>v("span",null,"Resume",-1)),pa=ve(()=>v("span",null,"Force Resume",-1)),va=ve(()=>v("span",null,"Pause",-1)),ha=ve(()=>v("span",null,"Delete",-1)),_a=I({__name:"RightClickMenu",props:{modelValue:{type:Boolean}},emits:["update:modelValue"],setup(T,{emit:e}){const l=T,{t:a}=Ie(),p=Ge(),g=ue(),V=Xe(),i=J(),c=ct(),_=S({get:()=>l.modelValue,set:n=>e("update:modelValue",n)}),y=S(()=>g.selectedTorrents.length>1),f=S(()=>g.selectedTorrents),$=S(()=>f.value[0]),x=S(()=>i.getTorrentByHash($.value)),C=S(()=>g.selectedTorrents.map(i.getTorrentByHash).filter(n=>!!n)),b=S(()=>[{name:""},...i.categories]);async function d(){await i.resumeTorrents(f)}async function k(){await i.forceResumeTorrents(f)}async function N(){await i.pauseTorrents(f)}function F(){V.createDialog(Je,{hashes:[...g.selectedTorrents]})}function oe(){V.createDialog(_t,{hashes:[...g.selectedTorrents]})}function he(){V.createDialog(da,{hash:g.selectedTorrents[0]})}async function le(){await i.recheckTorrents(f)}async function G(){await i.reannounceTorrents(f)}async function _e(){await i.toggleSeqDl(f)}async function fe(){await i.toggleFLPiecePrio(f)}async function be(){await i.toggleAutoTmm(f,!x.value?.auto_tmm)}function j(n){return C.value.every(h=>h&&h.tags&&h.tags.includes(n))}async function ge(n){j(n)?await i.removeTorrentTags(f.value,[n]):await i.addTorrentTags(f.value,[n])}async function Q(n){await navigator.clipboard.writeText(n)}function ne(){V.createDialog(Fe,{hash:$.value,mode:"download"})}function se(){V.createDialog(Fe,{hash:$.value,mode:"upload"})}function re(){V.createDialog(ua,{hash:$.value})}async function ye(){f.value.forEach(n=>{i.exportTorrent(n).then(h=>{const s=window.URL.createObjectURL(h),P=document.createElement("a");P.href=s,P.style.opacity="0",P.setAttribute("download",`${n}.torrent`),document.body.appendChild(P),P.click(),document.body.removeChild(P)})})}const W=S(()=>[{text:a("dashboard.right_click.advanced.title"),icon:"mdi-head-cog",children:[{text:a("dashboard.right_click.advanced.change_location"),icon:"mdi-folder",action:oe},{text:a("dashboard.right_click.advanced.rename"),icon:"mdi-rename-box",hidden:y.value,action:he},{text:a("dashboard.right_click.advanced.recheck"),icon:"mdi-playlist-check",action:le},{text:a("dashboard.right_click.advanced.reannounce"),icon:"mdi-bullhorn",action:G},{text:a("dashboard.right_click.advanced.seq_dl"),icon:x.value?.seq_dl?"mdi-checkbox-marked":"mdi-checkbox-blank-outline",action:_e},{text:a("dashboard.right_click.advanced.f_l_prio"),icon:x.value?.f_l_piece_prio?"mdi-checkbox-marked":"mdi-checkbox-blank-outline",action:fe},{text:a("dashboard.right_click.advanced.auto_tmm"),icon:x.value?.auto_tmm?"mdi-checkbox-marked":"mdi-checkbox-blank-outline",action:be}]},{text:a("dashboard.right_click.priority.title"),icon:"mdi-priority-high",hidden:!c.preferences.queueing_enabled,children:[{text:a("dashboard.right_click.priority.top"),icon:"mdi-priority-high",action:async()=>await i.setTorrentPriority(f.value,"topPrio")},{text:a("dashboard.right_click.priority.increase"),icon:"mdi-arrow-up",action:async()=>await i.setTorrentPriority(f.value,"increasePrio")},{text:a("dashboard.right_click.priority.decrease"),icon:"mdi-arrow-down",action:async()=>await i.setTorrentPriority(f.value,"decreasePrio")},{text:a("dashboard.right_click.priority.bottom"),icon:"mdi-priority-low",action:async()=>await i.setTorrentPriority(f.value,"bottomPrio")}]},{text:a("dashboard.right_click.tags.title"),icon:"mdi-tag",disabled:i.tags.length===0,disabledText:a("dashboard.right_click.tags.disabled_title"),disabledIcon:"mdi-tag-off",children:i.tags.map(n=>({text:n,icon:j(n)?"mdi-checkbox-marked":"mdi-checkbox-blank-outline",action:async()=>await ge(n)}))},{text:a("dashboard.right_click.category.title"),icon:"mdi-label",disabled:i.categories.length===0,disabledText:a("dashboard.right_click.category.disabled_title"),disabledIcon:"mdi-label-off",children:b.value.map(n=>({text:n.name===""?a("dashboard.right_click.category.clear"):n.name,action:async()=>await i.setTorrentCategory(f.value,n.name)}))},{text:a("dashboard.right_click.speed_limit.title"),icon:"mdi-speedometer-slow",children:[{text:a("dashboard.right_click.speed_limit.download"),icon:"mdi-download",action:ne},{text:a("dashboard.right_click.speed_limit.upload"),icon:"mdi-upload",action:se},{text:a("dashboard.right_click.speed_limit.share"),icon:"mdi-account-group",action:re}]},{text:a("dashboard.right_click.copy.title"),icon:"mdi-content-copy",hidden:y.value,children:[{text:a("dashboard.right_click.copy.name"),icon:"mdi-alphabetical-variant",action:async()=>x.value&&await Q(x.value.name)},{text:a("dashboard.right_click.copy.hash"),icon:"mdi-pound",action:async()=>await Q($.value)},{text:a("dashboard.right_click.copy.magnet"),icon:"mdi-magnet",action:async()=>x.value&&await Q(x.value.magnet)}]},{text:a("dashboard.right_click.export",g.selectedTorrents.length),icon:y.value?"mdi-download-multiple":"mdi-download",action:ye},{text:a("dashboard.right_click.info"),icon:"mdi-information",hidden:y.value,action:()=>p.push({name:"torrentDetail",params:{hash:$.value}})}]);return(n,h)=>_.value?(u(),B(Ye,{key:0,modelValue:_.value,"onUpdate:modelValue":h[0]||(h[0]=s=>_.value=s),activator:"parent","close-on-content-click":!0,transition:"slide-y-transition","scroll-strategy":"none"},{default:o(()=>[t(Ce,null,{default:o(()=>[t(Z,null,{default:o(()=>[v("div",ca,[t(K,{location:"top"},{activator:o(({props:s})=>[t(E,R({density:"compact",variant:"plain",icon:"mdi-play"},s,{onClick:d}),null,16)]),default:o(()=>[ma]),_:1}),t(K,{location:"top"},{activator:o(({props:s})=>[t(E,R({density:"compact",variant:"plain",icon:"mdi-fast-forward"},s,{onClick:k}),null,16)]),default:o(()=>[pa]),_:1}),t(K,{location:"top"},{activator:o(({props:s})=>[t(E,R({density:"compact",variant:"plain",icon:"mdi-pause"},s,{onClick:N}),null,16)]),default:o(()=>[va]),_:1}),t(K,{location:"top"},{activator:o(({props:s})=>[t(E,R({color:"red",density:"compact",variant:"plain",icon:"mdi-delete-forever"},s,{onClick:F}),null,16)]),default:o(()=>[ha]),_:1})])]),_:1}),(u(!0),w(X,null,te(W.value,s=>(u(),B(ia,Ke(He(s)),null,16))),256))]),_:1})]),_:1},8,["modelValue"])):O("",!0)}});const fa=Se(_a,[["__scopeId","data-v-18d5c938"]]),ba={class:"pt-4 px-1 px-sm-5"},ga={class:"pa-0",style:{width:"10em"}},ya={class:"text-uppercase",style:{float:"right","font-size":"0.8em"}},ka={class:"text-grey"},Ta={key:0,class:"mt-5 text-xs-center"},Va={class:"text-grey"},$a={key:1},wa={class:"d-flex align-center"},La=I({__name:"Dashboard",setup(T){const{t:e}=Ie(),l=Ge(),a=mt(),p=ue(),g=Xe(),{currentPage:V,filteredTorrents:i,isSelectionMultiple:c,selectedTorrents:_,sortOptions:y,torrentCountString:f}=pt(ue()),$=J(),x=ae(),C=[{value:"added_on",title:e("dashboard.sortBy.added_on")},{value:"amount_left",title:e("dashboard.sortBy.amount_left")},{value:"auto_tmm",title:e("dashboard.sortBy.auto_tmm")},{value:"availability",title:e("dashboard.sortBy.availability")},{value:"avg_download_speed",title:e("dashboard.sortBy.avg_download_speed")},{value:"avg_upload_speed",title:e("dashboard.sortBy.avg_upload_speed")},{value:"category",title:e("dashboard.sortBy.category")},{value:"completed",title:e("dashboard.sortBy.completed")},{value:"completion_on",title:e("dashboard.sortBy.completion_on")},{value:"content_path",title:e("dashboard.sortBy.content_path")},{value:"dl_limit",title:e("dashboard.sortBy.dl_limit")},{value:"dlspeed",title:e("dashboard.sortBy.dlspeed")},{value:"download_path",title:e("dashboard.sortBy.download_path")},{value:"downloaded",title:e("dashboard.sortBy.downloaded")},{value:"downloaded_session",title:e("dashboard.sortBy.downloaded_session")},{value:"eta",title:e("dashboard.sortBy.eta")},{value:"f_l_piece_prio",title:e("dashboard.sortBy.f_l_piece_prio")},{value:"force_start",title:e("dashboard.sortBy.force_start")},{value:"globalSpeed",title:e("dashboard.sortBy.globalSpeed")},{value:"globalVolume",title:e("dashboard.sortBy.globalVolume")},{value:"hash",title:e("dashboard.sortBy.hash")},{value:"infohash_v1",title:e("dashboard.sortBy.infohash_v1")},{value:"infohash_v2",title:e("dashboard.sortBy.infohash_v2")},{value:"last_activity",title:e("dashboard.sortBy.last_activity")},{value:"magnet_uri",title:e("dashboard.sortBy.magnet_uri")},{value:"max_ratio",title:e("dashboard.sortBy.max_ratio")},{value:"max_seeding_time",title:e("dashboard.sortBy.max_seeding_time")},{value:"name",title:e("dashboard.sortBy.name")},{value:"num_complete",title:e("dashboard.sortBy.num_complete")},{value:"num_incomplete",title:e("dashboard.sortBy.num_incomplete")},{value:"num_leechs",title:e("dashboard.sortBy.num_leechs")},{value:"num_seeds",title:e("dashboard.sortBy.num_seeds")},{value:"priority",title:e("dashboard.sortBy.priority")},{value:"progress",title:e("dashboard.sortBy.progress")},{value:"ratio",title:e("dashboard.sortBy.ratio")},{value:"ratio_limit",title:e("dashboard.sortBy.ratio_limit")},{value:"save_path",title:e("dashboard.sortBy.save_path")},{value:"seeding_time",title:e("dashboard.sortBy.seeding_time")},{value:"seeding_time_limit",title:e("dashboard.sortBy.seeding_time_limit")},{value:"seen_complete",title:e("dashboard.sortBy.seen_complete")},{value:"seq_dl",title:e("dashboard.sortBy.seq_dl")},{value:"size",title:e("dashboard.sortBy.size")},{value:"state",title:e("dashboard.sortBy.state")},{value:"super_seeding",title:e("dashboard.sortBy.super_seeding")},{value:"tags",title:e("dashboard.sortBy.tags")},{value:"time_active",title:e("dashboard.sortBy.time_active")},{value:"total_size",title:e("dashboard.sortBy.total_size")},{value:"tracker",title:e("dashboard.sortBy.tracker")},{value:"trackers_count",title:e("dashboard.sortBy.trackers_count")},{value:"up_limit",title:e("dashboard.sortBy.up_limit")},{value:"uploaded",title:e("dashboard.sortBy.uploaded")},{value:"uploaded_session",title:e("dashboard.sortBy.uploaded_session")},{value:"upspeed",title:e("dashboard.sortBy.upspeed")}].sort((n,h)=>n.title.localeCompare(h.title));C.splice(0,0,{value:"",title:e("dashboard.sortBy.default")});const b=L(!1),d=ze({isVisible:!1,offset:[0,0]}),k=S({get:()=>$.textFilter,set:bt(n=>{$.textFilter=n},300)}),{paginatedResults:N,currentPage:F,pageCount:oe}=ft(i,x.paginationSize,V),he=S(()=>!!$.textFilter&&$.textFilter.length>0),le=S(()=>i.value.length<=_.value.length);function G(n){b.value=n??!b.value,b.value&&Ue(()=>{document.getElementById("searchInput")?.focus()})}function _e(n){p.toggleSelect(n)}function fe(n){c.value||l.push({name:"torrentDetail",params:{hash:n}})}function be(){$.textFilter=""}function j(){window.scrollTo({top:0,behavior:"smooth"})}function ge(){c.value&&p.unselectAllTorrents(),c.value=!c.value}function Q(){le.value?p.unselectAllTorrents():p.selectTorrents(...i.value.map(n=>n.hash))}async function ne(n,h){n.preventDefault(),d.isVisible&&(d.isVisible=!1,await Ue()),d.isVisible=!0,d.offset=[n.pageX,n.pageY],c.value?_.value.length===0&&p.selectTorrent(h.hash):(p.unselectAllTorrents(),p.selectTorrent(h.hash))}tt(()=>d.isVisible,n=>{!n&&!c.value&&p.unselectAllTorrents()});function se(n){if(g.hasActiveDialog)return!1;const h=n.target;if(xe(n)&&n.key==="a"&&h.tagName!=="INPUT")return p.unselectAllTorrents(),p.selectTorrents(...i.value.map(s=>s.hash)),n.preventDefault(),!0;if(xe(n)&&n.key==="f"){const s=document.getElementById("searchInput");if(document.activeElement!==s)return G(!0),n.preventDefault(),!0}if(n.key==="Escape"){const s=document.getElementById("searchInput");return document.activeElement===s||b.value?G(!1):(c.value=!1,p.unselectAllTorrents()),n.preventDefault(),!0}if(n.key==="Delete")return _.value.length===0?void 0:(g.createDialog(Je,{hashes:p.selectedTorrents}),n.preventDefault(),!0);if(n.key==="/"){const s=document.getElementById("searchInput");return document.activeElement!==s&&!b.value&&(l.push({name:"searchEngine"}),n.preventDefault()),!0}}ce(async()=>{await $.fetchCategories(),await $.fetchTags(),G(he.value)}),qe(()=>{document.addEventListener("keydown",se),c.value=!1,j()}),at(()=>{document.removeEventListener("keydown",se)});const re=L();function ye(n,h){re.value=setTimeout(()=>{ne(n,h)},500)}function W(){clearTimeout(re.value)}return(n,h)=>(u(),w(X,null,[v("div",ba,[t(Be,{class:"ma-0 pa-0 mb-2"},{default:o(()=>[t(Re,null,{default:o(()=>[ke(t(z,{color:"transparent"},{default:o(()=>[t(q,{id:"searchInput",modelValue:k.value,"onUpdate:modelValue":h[0]||(h[0]=s=>k.value=s),label:r(e)("dashboard.searchInputLabel"),clearable:"",density:"compact","hide-details":"","prepend-inner-icon":"mdi-magnify",rounded:"pill","single-line":"",style:{width:"200px"},variant:"solo","onClick:clear":h[1]||(h[1]=s=>be())},null,8,["modelValue","label"])]),_:1},512),[[Te,b.value]])]),_:1}),t(K,{text:r(e)("dashboard.toggleSearchFilter"),location:"top"},{activator:o(({props:s})=>[t(E,R({icon:b.value?"mdi-chevron-left-circle":"mdi-text-box-search"},s,{variant:"plain",onClick:h[2]||(h[2]=P=>G())}),null,16,["icon"])]),_:1},8,["text"]),t(K,{text:r(e)("dashboard.toggleSelectMode"),location:"top"},{activator:o(({props:s})=>[t(E,R({icon:r(c)?"mdi-checkbox-marked":"mdi-checkbox-blank-outline"},s,{variant:"plain",onClick:ge}),null,16,["icon"])]),_:1},8,["text"]),t(K,{text:r(e)("dashboard.toggleSortOrder"),location:"top"},{activator:o(({props:s})=>[t(E,R({icon:r(y).reverseOrder?"mdi-arrow-up-thin":"mdi-arrow-down-thin"},s,{variant:"plain",onClick:h[3]||(h[3]=P=>r(y).reverseOrder=!r(y).reverseOrder)}),null,16,["icon"])]),_:1},8,["text"]),v("div",ga,[t(vt,{modelValue:r(y).sortBy,"onUpdate:modelValue":h[4]||(h[4]=s=>r(y).sortBy=s),items:r(C),label:r(e)("dashboard.sortLabel"),"auto-select-first":"",density:"compact","hide-details":"",variant:"solo-filled"},null,8,["modelValue","items","label"])]),t(ie,{class:"align-center justify-center"},{default:o(()=>[v("span",ya,m(r(f)),1)]),_:1})]),_:1}),t(Be,{class:"ma-0 pa-0"},{default:o(()=>[t(ht,null,{default:o(()=>[ke(t(z,{color:"transparent"},{default:o(()=>[t(K,{text:r(e)("common.selectAll"),location:"bottom"},{activator:o(({props:s})=>[t(E,R({icon:le.value?"mdi-checkbox-marked":"mdi-checkbox-blank-outline",class:"text-grey",color:"transparent",style:{left:"-8px"}},s,{onClick:Q}),null,16,["icon"])]),_:1},8,["text"]),v("span",ka,m(r(e)("dashboard.selectAll")),1)]),_:1},512),[[Te,r(c)]])]),_:1})]),_:1}),r(p).filteredTorrents.length===0?(u(),w("div",Ta,[v("p",Va,m(r(e)("common.emptyList")),1)])):(u(),w("div",$a,[t(Ce,{id:"torrentList",class:"pa-0",color:"transparent"},{default:o(()=>[r(x).isPaginationOnTop&&!r(x).isInfiniteScrollActive?(u(),B(Z,{key:0},{default:o(()=>[t(Ne,{modelValue:r(F),"onUpdate:modelValue":h[5]||(h[5]=s=>ee(F)?F.value=s:null),length:r(oe),"next-icon":"mdi-menu-right","prev-icon":"mdi-menu-left",onInput:j},null,8,["modelValue","length"])]),_:1})):O("",!0),(u(!0),w(X,null,te(r(N),s=>(u(),B(Z,{id:`torrent-${s.hash}`,class:Oe([r(a).mobile?"mb-2":"mb-4","pa-0"]),onContextmenu:P=>ne(P,s),onTouchcancel:W,onTouchend:W,onTouchmove:W,onTouchstart:ye,onDblclick:H(P=>fe(s.hash),["prevent"])},{default:o(()=>[v("div",wa,[t(Re,null,{default:o(()=>[ke(t(z,{class:"mr-3",color:"transparent"},{default:o(()=>[t(E,{icon:r(p).isTorrentInSelection(s.hash)?"mdi-checkbox-marked":"mdi-checkbox-blank-outline",color:"transparent",variant:"flat",onClick:P=>_e(s.hash)},null,8,["icon","onClick"])]),_:2},1536),[[Te,r(p).isSelectionMultiple]])]),_:2},1024),t(la,{torrent:s},null,8,["torrent"])])]),_:2},1032,["id","class","onContextmenu","onDblclick"]))),256)),!r(x).isPaginationOnTop&&!r(x).isInfiniteScrollActive?(u(),B(Z,{key:1},{default:o(()=>[t(Ne,{modelValue:r(F),"onUpdate:modelValue":h[6]||(h[6]=s=>ee(F)?F.value=s:null),length:r(oe),"next-icon":"mdi-menu-right","prev-icon":"mdi-menu-left",onInput:j},null,8,["modelValue","length"])]),_:1})):O("",!0)]),_:1})]))]),v("div",{style:ot(`position: absolute; left: ${d.offset[0]}px; top: ${d.offset[1]}px;`)},[t(fa,{modelValue:d.isVisible,"onUpdate:modelValue":h[7]||(h[7]=s=>d.isVisible=s)},null,8,["modelValue"])],4)],64))}});export{La as default};
